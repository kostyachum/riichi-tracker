{% load i18n %}

<!-- Highlights -->
<div class="mt-4 border-t border-base-200 pt-4">
  <div class="flex items-center justify-between">
    <h5 class="text-sm font-semibold uppercase tracking-wide text-base-content/70">
      {% trans "Highlights" %}
    </h5>
    <details class="dropdown dropdown-end">
      <summary class="btn btn-soft btn-sm">{% trans "Add Highlight" %}</summary>
      <div class="dropdown-content z-[1] card card-compact w-[20rem] bg-base-100 p-3 shadow">
        <form method="post" action="{% url 'game_highlight_create' %}" enctype="multipart/form-data">
          {% csrf_token %}
          <input type="hidden" name="game_id" value="{{ game.id }}">
          <div class="form-control mb-2">
            <label class="label">
              <span class="label-text">{% trans "Player" %}</span>
            </label>
            <select name="player_id" class="select select-bordered w-full">
              <option value="">{% trans "No player" %}</option>
              {% for result in game.gameresult_set.all %}
                <option value="{{ result.player.id }}">{{ result.player.name }}</option>
              {% endfor %}
            </select>
          </div>
          <div class="form-control mb-2">
            <label class="label">
              <span class="label-text">{% trans "Photos" %}</span>
            </label>
            <input type="file" name="photos" class="file-input file-input-bordered w-full" multiple>
          </div>
          <div class="form-control mb-3">
            <label class="label">
              <span class="label-text">{% trans "Caption" %}</span>
            </label>
            <input type="text" name="caption" class="input input-bordered w-full" maxlength="255">
          </div>
          <div class="flex justify-end">
            <button type="submit" class="btn btn-primary btn-sm">
              {% trans "Save" %}
            </button>
          </div>
        </form>
      </div>
    </details>
  </div>
  {% if game.highlights.exists %}
    <div class="mt-3 grid grid-cols-1 gap-3 md:grid-cols-2">
      {% for highlight in game.highlights.all %}
        <div class="card card-compact bg-base-200/40">
          <figure>
            <label for="highlight-{{ highlight.id }}" class="cursor-zoom-in">
              <img src="{{ highlight.photo.url }}" alt="{{ highlight.caption|default:_('Game highlight') }}" class="rounded-md">
            </label>
          </figure>
          <div class="card-body px-2 pb-1 pt-1 text-xs">
            {% if highlight.caption %}
              <div class="font-medium">{{ highlight.caption }}</div>
            {% endif %}
            {% if highlight.player %}
              <div class="text-base-content/60">{{ highlight.player.name }}</div>
            {% endif %}
          </div>
        </div>
        <input type="checkbox" id="highlight-{{ highlight.id }}" class="modal-toggle">
        <div class="modal" role="dialog">
          <div class="modal-box max-w-5xl p-3">
            <img src="{{ highlight.photo.url }}" alt="{{ highlight.caption|default:_('Game highlight') }}" class="w-full rounded-md">
            {% if highlight.caption %}
              <div class="mt-2 text-sm">{{ highlight.caption }}</div>
            {% endif %}
            {% if highlight.player %}
              <div class="text-xs text-base-content/60">{{ highlight.player.name }}</div>
            {% endif %}
          </div>
          <label class="modal-backdrop" for="highlight-{{ highlight.id }}"></label>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="mt-2 text-sm text-base-content/60">
      {% trans "No highlights yet." %}
    </div>
  {% endif %}
</div>
